/*! For license information please see text-chunk.js.LICENSE.txt */
(this.webpackChunkCoCreate_cursors=this.webpackChunkCoCreate_cursors||[]).push([["text-chunk"],{"../CoCreate-text/src/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.default = void 0;\n\nvar _observer = _interopRequireDefault(__webpack_require__(/*! @cocreate/observer */ \"../CoCreate-observer/src/index.js\"));\n\nvar _crudClient = _interopRequireDefault(__webpack_require__(/*! @cocreate/crud-client */ \"../CoCreate-crud-client/src/index.js\"));\n\nvar _crdt = _interopRequireDefault(__webpack_require__(/*! @cocreate/crdt */ \"../CoCreate-crdt/src/index.js\"));\n\nvar _cursors = _interopRequireDefault(__webpack_require__(/*! @cocreate/cursors */ \"./src/index.js\"));\n\nvar _form = _interopRequireDefault(__webpack_require__(/*! @cocreate/form */ \"../CoCreate-form/src/index.js\"));\n\nvar _floatingLabel = _interopRequireDefault(__webpack_require__(/*! @cocreate/floating-label */ \"../CoCreate-floating-label/src/index.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst CoCreateText = {\n  elements: [],\n  init: function () {\n    this.initElement(document); // this.initSockets();\n  },\n  refreshElement: function (mutation) {\n    let element = mutation.target;\n    if (!element) return;\n    const tagName = element.tagName.toLowerCase();\n\n    if (!['input', 'textarea'].includes(tagName) || !element.getAttribute('data-document_id') || !element.getAttribute('name')) {\n      return;\n    }\n\n    if (!_crudClient.default.isCRDT(element)) return;\n\n    if (!_observer.default.getInitialized(element, 'text')) {\n      this.__initEvents(element);\n    }\n\n    _observer.default.setInitialized(element, 'text');\n\n    if (_form.default.checkID(element)) {\n      // element.value = \"\";\n      this.createYDoc(element, true);\n    }\n  },\n  initElement: function (container) {\n    var self = this;\n    let fetch_container = container || document;\n    let elements = fetch_container.querySelectorAll('input[data-document_id][name], textarea[data-document_id][name]');\n\n    if (elements.length == 0 && fetch_container != document && fetch_container.hasAttribute('data-document_id') && fetch_container.hasAttribute('name')) {\n      elements = [fetch_container];\n    }\n\n    elements.forEach(element => {\n      if (!_crudClient.default.isCRDT(element)) {\n        return;\n      }\n\n      if (self.checkExistElement(element)) {\n        // this.setInitValue(elements[i])\n        return;\n      }\n\n      if (_observer.default.getInitialized(element, 'text')) {\n        return;\n      }\n\n      _observer.default.setInitialized(element, 'text');\n\n      self.__initEvents(element);\n\n      if (_form.default.checkID(element)) {\n        self.createYDoc(element);\n      } else {\n        //. register create document_id event\n        element.addEventListener('set-document_id', function (event) {\n          let el = this;\n          let text_str = el.value;\n          self.createYDoc(el);\n          el.value = \"\";\n          self.sendChangeData(el, text_str, 0, text_str.length);\n        });\n      }\n    });\n  },\n  checkExistElement: function (element) {\n    for (var i = 0; i < this.elements.length; i++) {\n      if (this.elements[i].isSameNode(element)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  setInitValue: function (element) {\n    var typeId = this.generateTypeName(element);\n\n    var value = _crdt.default.getWholeString(typeId);\n\n    element.value = value; // input.setValue(element, value);\n  },\n  createYDoc: function (element, isExclude) {\n    const {\n      collection,\n      document_id,\n      name\n    } = _crudClient.default.getAttr(element);\n\n    if (!_crudClient.default.checkValue(collection) || !_crudClient.default.checkValue(document_id) || !_crudClient.default.checkValue(name)) return;\n\n    const status = _crdt.default.init({\n      collection,\n      document_id,\n      name,\n      element\n    });\n\n    if (!isExclude) {\n      this.elements.push(element);\n    } else {\n      element.value = _crdt.default.getText({\n        collection,\n        document_id,\n        name\n      }); // input.setValue(element, crdt.getText({collection, document_id, name }));\n    }\n  },\n  __initEvents: function (input_element) {\n    //. selection event\n    const self = this;\n    input_element.addEventListener('select', function () {\n      if (this.selectionEnd !== this.selectionStart) {\n        self.setSelectionInfo(this, true, this.selectionStart, this.selectionEnd);\n        if (document.activeElement === this) self.sendPosition(this);\n      }\n    });\n    input_element.addEventListener('keyup', function (event) {\n      let arrows = [37, 38, 39, 40];\n\n      if (arrows.indexOf(event.keyCode) != -1) {\n        self.sendPosition(this);\n      }\n    });\n    input_element.addEventListener('keydown', function (event) {\n      let arrows = [37, 38, 39, 40];\n\n      if (arrows.indexOf(event.keyCode) != -1) {\n        //console.log(\"keydown ---- \")\n        self.sendPosition(this);\n      }\n    });\n    input_element.addEventListener('click', function (event) {\n      if (document.activeElement === this) self.sendPosition(this);\n    });\n    input_element.addEventListener('blur', function (event) {\n      const id = self.generateTypeName(this);\n\n      _crdt.default.setCursorNull(id);\n    });\n    input_element.addEventListener('input', function (event) {\n      let nowstart = this.selectionStart - 1;\n      let nowend = nowstart;\n      let selection_info = self.getSelectionInfo(this);\n      let content_text = \"\";\n      let isUpdate = false;\n\n      switch (event.inputType) {\n        case 'deleteContentBackward':\n          isUpdate = true;\n          nowstart++;\n          nowend = nowstart + 1;\n          break;\n\n        case 'deleteContentForward':\n          isUpdate = true;\n          nowstart++;\n          nowend = nowstart + 1;\n          break;\n\n        case 'insertLineBreak':\n          isUpdate = true;\n          content_text = \"\\n\";\n          nowend++;\n          break;\n\n        case 'insertText':\n          isUpdate = true;\n          content_text = event.data || \"\\n\";\n          break;\n\n        case 'deleteByCut':\n          isUpdate = true;\n          break;\n      }\n\n      if (isUpdate) {\n        if (selection_info.is_selected) {\n          //. delete event\n          let character_deleted = selection_info.start - selection_info.end; //cursors.recalculate_local_cursors(this,character_deleted)\n\n          self.sendChangeData(this, \"\", selection_info.start, selection_info.end);\n\n          if (content_text.length > 0) {\n            self.sendChangeData(this, content_text, nowstart, nowend);\n          }\n\n          self.setSelectionInfo(this, false, this.selectionStart, this.selectionStart);\n        } else {\n          self.sendChangeData(this, content_text, nowstart, nowend);\n        }\n      }\n    });\n    /** unselect events **/\n\n    input_element.addEventListener('blur', function (e) {\n      self.setSelectionInfo(this, false, this.selectionStart, this.selectionStart);\n    });\n    input_element.addEventListener('click', function (e) {\n      self.setSelectionInfo(this, false, this.selectionStart, this.selectionStart);\n    });\n    /** past events **/\n\n    input_element.addEventListener('paste', function (event) {\n      let content_text = event.clipboardData.getData('Text');\n      let start = this.selectionStart;\n      let end = this.selectionEnd; //. send delete event\n\n      if (start != end) {\n        this.setSelectionRange(end, end);\n        self.sendChangeData(this, \"\", start, end, false);\n      }\n\n      if (start == end) {// to calculate Cursors in collaboration \n        // cursors.recalculate_local_cursors(this,content_text.length)\n      } //. insert event\n\n\n      self.sendChangeData(this, content_text, start, start, false);\n      event.preventDefault();\n    });\n    input_element.addEventListener('cocreate-crdt-update', function (event) {\n      var info = event.detail;\n      input_element.crudSetted = true;\n      var pos = 0;\n      var flag = true;\n      info.forEach(item => {\n        if (item.retain) {\n          flag = true;\n          pos = item.retain;\n        }\n\n        if (item.insert || item.delete) {\n          if (flag == false) pos = 0;\n          flag = false;\n\n          if (item.insert) {\n            //. insert process\n            self.updateChangeData(this, item.insert, pos, pos);\n          } else if (item.delete) {\n            //. delete process\n            self.updateChangeData(this, \"\", pos, pos + item.delete);\n          }\n        }\n      });\n    });\n  },\n  setSelectionInfo: function (e, isSelect, start, end) {\n    e.setAttribute(\"is_selected\", isSelect);\n    e.setAttribute(\"selection_start\", start);\n    e.setAttribute(\"selection_end\", end); //console.log(\"swelect\",e)\n\n    this.sendPosition(e);\n  },\n  getSelectionInfo: function (e) {\n    return {\n      is_selected: e.getAttribute(\"is_selected\") === 'true' ? true : false,\n      start: parseInt(e.getAttribute(\"selection_start\")),\n      end: parseInt(e.getAttribute(\"selection_end\"))\n    };\n  },\n  sendChangeData: function (element, content, start, end, isRemove = true) {\n    const {\n      collection,\n      document_id,\n      name\n    } = _crudClient.default.getAttr(element);\n\n    if (!document_id || document_id === \"\") {\n      _form.default.request({\n        element: element,\n        nameAttr: \"name\"\n      });\n\n      element.setAttribute('data-document_id', 'pending');\n      return;\n    }\n\n    if (document_id == 'pending') {\n      return;\n    }\n\n    if (!_crudClient.default.isSaveAttr(element)) {\n      return;\n    } //console.log(\"SendChangeDataFrom Cocreate-Text\")\n\n\n    let character_count = content.length > 0 ? content.length : -1;\n\n    _cursors.default.recalculate_local_cursors(element, character_count); //send position when keyUp \n\n\n    this.sendPosition(element);\n\n    if (content.length > 0) {\n      if (isRemove) {\n        element.setRangeText(\"\", start, start + content.length, \"start\");\n      }\n\n      _crdt.default.insertText({\n        collection,\n        document_id,\n        name,\n        value: content,\n        position: start\n      });\n    } else {\n      if (isRemove) element.setRangeText(\" \".repeat(end - start), start, start, \"end\");\n\n      _crdt.default.deleteText({\n        collection,\n        document_id,\n        name,\n        position: start,\n        length: end - start\n      });\n    }\n\n    if (document.activeElement === element) {\n      this.setSelectionInfo(element, false, element.selectionStart, element.selectionStart);\n      this.sendPosition(element);\n    }\n  },\n  updateChangeData: function (element, content, start, end) {\n    let prev_start = element.selectionStart;\n    let prev_end = element.selectionEnd;\n    element.setRangeText(content, start, end, \"end\");\n\n    if (prev_start >= start) {\n      if (content == \"\") {\n        prev_start -= end - start;\n        prev_end -= end - start;\n        prev_start = prev_start < start ? start : prev_start;\n      } else {\n        prev_start += content.length;\n        prev_end += content.length;\n      }\n    }\n\n    {\n      if (content == \"\" && prev_end >= start) {\n        prev_end = prev_end >= end ? prev_end - (end - start) : start;\n      }\n    }\n    element.selectionStart = prev_start;\n    element.selectionEnd = prev_end;\n    var isFocused = document.activeElement === element;\n\n    _cursors.default.refresh_mirror(element);\n\n    if (_floatingLabel.default) {\n      _floatingLabel.default.update(element, element.value);\n    }\n  },\n  generateTypeName: function (element) {\n    const {\n      collection,\n      document_id,\n      name\n    } = _crudClient.default.getAttr(element);\n\n    return _crdt.default.generateID(config.organization_Id, collection, document_id, name);\n  },\n  setText: function (element_id, info) {\n    var pos = 0;\n    var flag = true;\n    info.forEach(item => {\n      if (item.retain) {\n        flag = true;\n        pos = item.retain;\n      }\n\n      if (item.insert || item.delete) {\n        if (flag == false) pos = 0;\n        flag = false;\n\n        if (item.insert) {\n          //. insert process\n          this.receiveChangeData(element_id, item.insert, pos, pos);\n        } else if (item.delete) {\n          //. delete process\n          this.receiveChangeData(element_id, \"\", pos, pos + item.delete);\n        }\n      }\n    });\n  },\n  isAvaiableEl: function (element) {\n    //console.log(this.elements)\n    for (var i = 0; i < this.elements.length; i++) {\n      console.log(this.elements[i].isEqualNode(element), element);\n\n      if (this.elements[i].isEqualNode(element) === true) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  sendPosition: function (element) {\n    //console.log(\"Se envio \")\n\n    /*if (!this.isAvaiableEl(element)) {\n      return;\n    }*/\n    const id = this.generateTypeName(element); //console.log(\" SEnd Position Selector ID \",id)\n    //console.log(element.selectionStart, element.selectionEnd);\n\n    let from = element.selectionStart;\n    let to = element.selectionEnd; //console.log(\"Se envio la position \",id,from, to)\n\n    _crdt.default.setPositionYJS(id, from, to);\n  }\n};\nCoCreateText.init(); // CoCreateInit.register('CoCreateText', CoCreateText, CoCreateText.initElement);\n\n_observer.default.init({\n  name: 'CoCreateTextCreate',\n  observe: ['subtree', 'childList'],\n  include: '[data-collection][data-document_id][name]',\n  callback: function (mutation) {\n    console.log('cocreate-text init');\n    CoCreateText.initElement(mutation.target);\n  }\n});\n\n_observer.default.init({\n  name: 'CoCreateTextNameObserver',\n  observe: ['attributes'],\n  attributes: ['name'],\n  callback: function (mutation) {\n    console.log('change cocreate-text name');\n    CoCreateText.refreshElement(mutation);\n  }\n});\n\nvar _default = CoCreateText;\nexports.default = _default;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5jdXJzb3JzLy4uL0NvQ3JlYXRlLXRleHQvc3JjL2luZGV4LmpzPzc4OWIiXSwibmFtZXMiOlsiQ29DcmVhdGVUZXh0IiwiZWxlbWVudHMiLCJpbml0IiwiaW5pdEVsZW1lbnQiLCJkb2N1bWVudCIsInJlZnJlc2hFbGVtZW50IiwibXV0YXRpb24iLCJlbGVtZW50IiwidGFyZ2V0IiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJnZXRBdHRyaWJ1dGUiLCJjcnVkIiwiaXNDUkRUIiwib2JzZXJ2ZXIiLCJnZXRJbml0aWFsaXplZCIsIl9faW5pdEV2ZW50cyIsInNldEluaXRpYWxpemVkIiwiZm9ybSIsImNoZWNrSUQiLCJjcmVhdGVZRG9jIiwiY29udGFpbmVyIiwic2VsZiIsImZldGNoX2NvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJoYXNBdHRyaWJ1dGUiLCJmb3JFYWNoIiwiY2hlY2tFeGlzdEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJlbCIsInRleHRfc3RyIiwidmFsdWUiLCJzZW5kQ2hhbmdlRGF0YSIsImkiLCJpc1NhbWVOb2RlIiwic2V0SW5pdFZhbHVlIiwidHlwZUlkIiwiZ2VuZXJhdGVUeXBlTmFtZSIsImNyZHQiLCJnZXRXaG9sZVN0cmluZyIsImlzRXhjbHVkZSIsImNvbGxlY3Rpb24iLCJkb2N1bWVudF9pZCIsIm5hbWUiLCJnZXRBdHRyIiwiY2hlY2tWYWx1ZSIsInN0YXR1cyIsInB1c2giLCJnZXRUZXh0IiwiaW5wdXRfZWxlbWVudCIsInNlbGVjdGlvbkVuZCIsInNlbGVjdGlvblN0YXJ0Iiwic2V0U2VsZWN0aW9uSW5mbyIsImFjdGl2ZUVsZW1lbnQiLCJzZW5kUG9zaXRpb24iLCJhcnJvd3MiLCJpbmRleE9mIiwia2V5Q29kZSIsImlkIiwic2V0Q3Vyc29yTnVsbCIsIm5vd3N0YXJ0Iiwibm93ZW5kIiwic2VsZWN0aW9uX2luZm8iLCJnZXRTZWxlY3Rpb25JbmZvIiwiY29udGVudF90ZXh0IiwiaXNVcGRhdGUiLCJpbnB1dFR5cGUiLCJkYXRhIiwiaXNfc2VsZWN0ZWQiLCJjaGFyYWN0ZXJfZGVsZXRlZCIsInN0YXJ0IiwiZW5kIiwiZSIsImNsaXBib2FyZERhdGEiLCJnZXREYXRhIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJwcmV2ZW50RGVmYXVsdCIsImluZm8iLCJkZXRhaWwiLCJjcnVkU2V0dGVkIiwicG9zIiwiZmxhZyIsIml0ZW0iLCJyZXRhaW4iLCJpbnNlcnQiLCJkZWxldGUiLCJ1cGRhdGVDaGFuZ2VEYXRhIiwiaXNTZWxlY3QiLCJzZXRBdHRyaWJ1dGUiLCJwYXJzZUludCIsImNvbnRlbnQiLCJpc1JlbW92ZSIsInJlcXVlc3QiLCJuYW1lQXR0ciIsImlzU2F2ZUF0dHIiLCJjaGFyYWN0ZXJfY291bnQiLCJjdXJzb3JzIiwicmVjYWxjdWxhdGVfbG9jYWxfY3Vyc29ycyIsInNldFJhbmdlVGV4dCIsImluc2VydFRleHQiLCJwb3NpdGlvbiIsInJlcGVhdCIsImRlbGV0ZVRleHQiLCJwcmV2X3N0YXJ0IiwicHJldl9lbmQiLCJpc0ZvY3VzZWQiLCJyZWZyZXNoX21pcnJvciIsImZsb2F0aW5nTGFiZWwiLCJ1cGRhdGUiLCJnZW5lcmF0ZUlEIiwiY29uZmlnIiwib3JnYW5pemF0aW9uX0lkIiwic2V0VGV4dCIsImVsZW1lbnRfaWQiLCJyZWNlaXZlQ2hhbmdlRGF0YSIsImlzQXZhaWFibGVFbCIsImNvbnNvbGUiLCJsb2ciLCJpc0VxdWFsTm9kZSIsImZyb20iLCJ0byIsInNldFBvc2l0aW9uWUpTIiwib2JzZXJ2ZSIsImluY2x1ZGUiLCJjYWxsYmFjayIsImF0dHJpYnV0ZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUVBLE1BQU1BLFlBQVksR0FBRztBQUNuQkMsVUFBUSxFQUFFLEVBRFM7QUFHbkJDLE1BQUksRUFBRyxZQUFXO0FBQ2hCLFNBQUtDLFdB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RyxXQUFiLENBQXlCRyxRQUFRLENBQUNFLE1BQWxDO0FBQ0E7QUFQWSxDQUFkOztBQVVBTyxrQkFBU2IsSUFBVCxDQUFjO0FBQ2I0QyxNQUFJLEVBQUUsMEJBRE87QUFFYitFLFNBQU8sRUFBRSxDQUFDLFlBQUQsQ0FGSTtBQUdiRyxZQUFVLEVBQUUsQ0FBQyxNQUFELENBSEM7QUFJYkQsVUFBUSxFQUFFLFVBQVN6SCxRQUFULEVBQW1CO0FBQzVCaUgsV0FBTyxDQUFDQyxHQUFSLENBQVksMkJBQVo7QUFDQXhILGdCQUFZLENBQUNLLGNBQWIsQ0FBNEJDLFFBQTVCO0FBQ0E7QUFQWSxDQUFkOztlQVVlTixZIiwiZmlsZSI6Ii4uL0NvQ3JlYXRlLXRleHQvc3JjL2luZGV4LmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG9ic2VydmVyIGZyb20gJ0Bjb2NyZWF0ZS9vYnNlcnZlcidcbmltcG9ydCBjcnVkIGZyb20gJ0Bjb2NyZWF0ZS9jcnVkLWNsaWVudCdcbmltcG9ydCBjcmR0IGZyb20gJ0Bjb2NyZWF0ZS9jcmR0J1xuaW1wb3J0IGN1cnNvcnMgZnJvbSAnQGNvY3JlYXRlL2N1cnNvcnMnXG5pbXBvcnQgZm9ybSBmcm9tICdAY29jcmVhdGUvZm9ybSdcbmltcG9ydCBmbG9hdGluZ0xhYmVsIGZyb20gJ0Bjb2NyZWF0ZS9mbG9hdGluZy1sYWJlbCdcblxuY29uc3QgQ29DcmVhdGVUZXh0ID0ge1xuICBlbGVtZW50czogW10sXG4gIFxuICBpbml0IDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0RWxlbWVudChkb2N1bWVudCk7XG4gICAgLy8gdGhpcy5pbml0U29ja2V0cygpO1xuICB9LFxuICBcbiAgcmVmcmVzaEVsZW1lbnQ6IGZ1bmN0aW9uKG11dGF0aW9uKSB7XG4gICAgbGV0IGVsZW1lbnQgPSBtdXRhdGlvbi50YXJnZXQ7XG4gICAgaWYgKCFlbGVtZW50KSByZXR1cm47XG4gICAgY29uc3QgdGFnTmFtZSA9IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICghWydpbnB1dCcsICd0ZXh0YXJlYSddLmluY2x1ZGVzKHRhZ05hbWUpIHx8XG4gICAgICAgICFlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1kb2N1bWVudF9pZCcpIHx8XG4gICAgICAgICFlbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpKSB7XG4gICAgICByZXR1cm4gXG4gICAgfVxuICAgIFxuICAgIGlmICghY3J1ZC5pc0NSRFQoZWxlbWVudCkpIHJldHVybjtcbiAgICBcbiAgICBpZiAoIW9ic2VydmVyLmdldEluaXRpYWxpemVkKGVsZW1lbnQsICd0ZXh0JykpIHtcbiAgICAgIHRoaXMuX19pbml0RXZlbnRzKGVsZW1lbnQpO1xuICAgIH1cbiAgICBvYnNlcnZlci5zZXRJbml0aWFsaXplZChlbGVtZW50LCAndGV4dCcpO1xuICAgIFxuICAgIGlmIChmb3JtLmNoZWNrSUQoZWxlbWVudCkpIHtcbiAgICAgIC8vIGVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgICAgdGhpcy5jcmVhdGVZRG9jKGVsZW1lbnQsIHRydWUpO1xuICAgIH1cbiAgICBcbiAgfSxcbiAgXG4gIGluaXRFbGVtZW50OiBmdW5jdGlvbihjb250YWluZXIpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgbGV0IGZldGNoX2NvbnRhaW5lciA9IGNvbnRhaW5lciB8fCBkb2N1bWVudDtcbiAgICBcbiAgICBsZXQgZWxlbWVudHMgPSBmZXRjaF9jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbZGF0YS1kb2N1bWVudF9pZF1bbmFtZV0sIHRleHRhcmVhW2RhdGEtZG9jdW1lbnRfaWRdW25hbWVdJyk7XG4gICAgaWYgKGVsZW1lbnRzLmxlbmd0aCA9PSAwICYmIFxuICAgICAgICBmZXRjaF9jb250YWluZXIgIT0gZG9jdW1lbnQgJiZcbiAgICAgICAgZmV0Y2hfY29udGFpbmVyLmhhc0F0dHJpYnV0ZSgnZGF0YS1kb2N1bWVudF9pZCcpICYmIFxuICAgICAgICBmZXRjaF9jb250YWluZXIuaGFzQXR0cmlidXRlKCduYW1lJykpIFxuICAgIHtcbiAgICAgIGVsZW1lbnRzID0gW2ZldGNoX2NvbnRhaW5lcl07XG4gICAgfVxuXG4gICAgZWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgaWYgKCFjcnVkLmlzQ1JEVChlbGVtZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChzZWxmLmNoZWNrRXhpc3RFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgICAgIC8vIHRoaXMuc2V0SW5pdFZhbHVlKGVsZW1lbnRzW2ldKVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcblx0XHRcdGlmIChvYnNlcnZlci5nZXRJbml0aWFsaXplZChlbGVtZW50LCAndGV4dCcpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdG9ic2VydmVyLnNldEluaXRpYWxpemVkKGVsZW1lbnQsICd0ZXh0Jyk7XG4gICAgICBcbiAgICAgIHNlbGYuX19pbml0RXZlbnRzKGVsZW1lbnQpO1xuICAgICAgXG4gICAgICBpZiAoZm9ybS5jaGVja0lEKGVsZW1lbnQpKSB7XG4gICAgICAgIHNlbGYuY3JlYXRlWURvYyhlbGVtZW50KTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8uIHJlZ2lzdGVyIGNyZWF0ZSBkb2N1bWVudF9pZCBldmVudFxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3NldC1kb2N1bWVudF9pZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgbGV0IGVsID0gdGhpcztcbiAgICAgICAgICBsZXQgdGV4dF9zdHIgPSBlbC52YWx1ZTtcbiAgICAgICAgICBcbiAgICAgICAgICBzZWxmLmNyZWF0ZVlEb2MoZWwpO1xuICAgICAgICAgIFxuICAgICAgICAgIGVsLnZhbHVlID0gXCJcIjtcbiAgICAgICAgICBzZWxmLnNlbmRDaGFuZ2VEYXRhKGVsLCB0ZXh0X3N0ciwgMCwgdGV4dF9zdHIubGVuZ3RoKTtcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuICBcbiAgY2hlY2tFeGlzdEVsZW1lbnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmVsZW1lbnRzW2ldLmlzU2FtZU5vZGUoZWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgXG4gIHNldEluaXRWYWx1ZTogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHZhciB0eXBlSWQgPSB0aGlzLmdlbmVyYXRlVHlwZU5hbWUoZWxlbWVudCk7XG4gICAgdmFyIHZhbHVlID0gY3JkdC5nZXRXaG9sZVN0cmluZyh0eXBlSWQpO1xuICAgIGVsZW1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICBcbiAgICAvLyBpbnB1dC5zZXRWYWx1ZShlbGVtZW50LCB2YWx1ZSk7XG4gIH0sXG4gIFxuICBjcmVhdGVZRG9jOiBmdW5jdGlvbihlbGVtZW50LCBpc0V4Y2x1ZGUpIHtcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lIH0gPSBjcnVkLmdldEF0dHIoZWxlbWVudClcbiAgICBpZiAoIWNydWQuY2hlY2tWYWx1ZShjb2xsZWN0aW9uKSB8fCAhY3J1ZC5jaGVja1ZhbHVlKGRvY3VtZW50X2lkKSB8fCAhY3J1ZC5jaGVja1ZhbHVlKG5hbWUpKSByZXR1cm47XG4gICAgY29uc3Qgc3RhdHVzID0gY3JkdC5pbml0KHsgY29sbGVjdGlvbiwgZG9jdW1lbnRfaWQsIG5hbWUsIGVsZW1lbnQgfSlcbiAgICBpZiAoIWlzRXhjbHVkZSkge1xuICAgICAgdGhpcy5lbGVtZW50cy5wdXNoKGVsZW1lbnQpXG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQudmFsdWUgPSBjcmR0LmdldFRleHQoe2NvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lIH0pXG4gICAgICAvLyBpbnB1dC5zZXRWYWx1ZShlbGVtZW50LCBjcmR0LmdldFRleHQoe2NvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lIH0pKTtcbiAgICB9XG4gIH0sXG4gIFxuICBcbiAgX19pbml0RXZlbnRzOiBmdW5jdGlvbihpbnB1dF9lbGVtZW50KSB7XG5cbiAgICAvLy4gc2VsZWN0aW9uIGV2ZW50XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgXG4gICAgaW5wdXRfZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzZWxlY3QnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLnNlbGVjdGlvbkVuZCAhPT0gdGhpcy5zZWxlY3Rpb25TdGFydCkge1xuICAgICAgICBzZWxmLnNldFNlbGVjdGlvbkluZm8odGhpcywgdHJ1ZSwgdGhpcy5zZWxlY3Rpb25TdGFydCwgdGhpcy5zZWxlY3Rpb25FbmQpXG4gICAgICAgIFxuICAgICAgICBpZihkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSB0aGlzKVxuICAgICAgICAgIHNlbGYuc2VuZFBvc2l0aW9uKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIGlucHV0X2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBsZXQgYXJyb3dzID0gWzM3LDM4LDM5LDQwXTtcbiAgICAgICAgaWYoYXJyb3dzLmluZGV4T2YoZXZlbnQua2V5Q29kZSkhPS0xKXtcbiAgICAgICAgICBzZWxmLnNlbmRQb3NpdGlvbih0aGlzKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIGlucHV0X2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGxldCBhcnJvd3MgPSBbMzcsMzgsMzksNDBdO1xuICAgICAgICBpZihhcnJvd3MuaW5kZXhPZihldmVudC5rZXlDb2RlKSE9LTEpe1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJrZXlkb3duIC0tLS0gXCIpXG4gICAgICAgICAgc2VsZi5zZW5kUG9zaXRpb24odGhpcyk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICBpbnB1dF9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcylcbiAgICAgICAgICBzZWxmLnNlbmRQb3NpdGlvbih0aGlzKTtcbiAgICB9KTtcbiAgICBcbiAgICBpbnB1dF9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBjb25zdCBpZCA9IHNlbGYuZ2VuZXJhdGVUeXBlTmFtZSh0aGlzKTtcbiAgICAgICAgY3JkdC5zZXRDdXJzb3JOdWxsKGlkKTtcbiAgICB9KTtcbiAgICBcbiAgICBpbnB1dF9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGxldCBub3dzdGFydCA9IHRoaXMuc2VsZWN0aW9uU3RhcnQgLSAxO1xuICAgICAgbGV0IG5vd2VuZCA9IG5vd3N0YXJ0O1xuICAgICAgbGV0IHNlbGVjdGlvbl9pbmZvID0gc2VsZi5nZXRTZWxlY3Rpb25JbmZvKHRoaXMpO1xuICAgICAgbGV0IGNvbnRlbnRfdGV4dCA9IFwiXCI7XG4gICAgICBsZXQgaXNVcGRhdGUgPSBmYWxzZTsgICAgICBcbiAgICAgIHN3aXRjaCAoZXZlbnQuaW5wdXRUeXBlKSB7XG4gICAgICAgIGNhc2UgJ2RlbGV0ZUNvbnRlbnRCYWNrd2FyZCc6XG4gICAgICAgICAgaXNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIG5vd3N0YXJ0ICsrO1xuICAgICAgICAgIG5vd2VuZCA9IG5vd3N0YXJ0ICsgMTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlQ29udGVudEZvcndhcmQnOlxuICAgICAgICAgIGlzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICBub3dzdGFydCArKztcbiAgICAgICAgICBub3dlbmQgPSBub3dzdGFydCArIDE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2luc2VydExpbmVCcmVhayc6XG4gICAgICAgICAgaXNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIGNvbnRlbnRfdGV4dCA9IFwiXFxuXCI7XG4gICAgICAgICAgbm93ZW5kICsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdpbnNlcnRUZXh0JzpcbiAgICAgICAgICBpc1VwZGF0ZSA9IHRydWU7XG4gICAgICAgICAgY29udGVudF90ZXh0ID0gZXZlbnQuZGF0YSB8fCBcIlxcblwiO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkZWxldGVCeUN1dCc6XG4gICAgICAgICAgaXNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChpc1VwZGF0ZSkge1xuICAgICAgICBpZiAoc2VsZWN0aW9uX2luZm8uaXNfc2VsZWN0ZWQpIHtcbiAgICAgICAgICAvLy4gZGVsZXRlIGV2ZW50XG4gICAgICAgICAgbGV0IGNoYXJhY3Rlcl9kZWxldGVkID0gc2VsZWN0aW9uX2luZm8uc3RhcnQgLSBzZWxlY3Rpb25faW5mby5lbmQ7XG4gICAgICAgICAgXG4gICAgICAgICAgLy9jdXJzb3JzLnJlY2FsY3VsYXRlX2xvY2FsX2N1cnNvcnModGhpcyxjaGFyYWN0ZXJfZGVsZXRlZClcbiAgICAgICAgICBcbiAgICAgICAgICBzZWxmLnNlbmRDaGFuZ2VEYXRhKHRoaXMsIFwiXCIsIHNlbGVjdGlvbl9pbmZvLnN0YXJ0LCBzZWxlY3Rpb25faW5mby5lbmQpO1xuICAgICAgICAgIGlmIChjb250ZW50X3RleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2VsZi5zZW5kQ2hhbmdlRGF0YSh0aGlzLCBjb250ZW50X3RleHQsIG5vd3N0YXJ0LCBub3dlbmQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZWxmLnNldFNlbGVjdGlvbkluZm8odGhpcywgZmFsc2UsIHRoaXMuc2VsZWN0aW9uU3RhcnQsIHRoaXMuc2VsZWN0aW9uU3RhcnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNlbGYuc2VuZENoYW5nZURhdGEodGhpcywgY29udGVudF90ZXh0LCBub3dzdGFydCwgbm93ZW5kKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvKiogdW5zZWxlY3QgZXZlbnRzICoqLyAgICBcbiAgICBpbnB1dF9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbihlKSB7XG4gICAgICBzZWxmLnNldFNlbGVjdGlvbkluZm8odGhpcywgZmFsc2UsIHRoaXMuc2VsZWN0aW9uU3RhcnQsIHRoaXMuc2VsZWN0aW9uU3RhcnQpO1xuICAgIH0pXG4gICAgaW5wdXRfZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHNlbGYuc2V0U2VsZWN0aW9uSW5mbyh0aGlzLCBmYWxzZSwgdGhpcy5zZWxlY3Rpb25TdGFydCwgdGhpcy5zZWxlY3Rpb25TdGFydCk7XG4gICAgfSlcbiAgICBcbiAgICAvKiogcGFzdCBldmVudHMgKiovXG4gICAgaW5wdXRfZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwYXN0ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBsZXQgY29udGVudF90ZXh0ID0gZXZlbnQuY2xpcGJvYXJkRGF0YS5nZXREYXRhKCdUZXh0Jyk7XG4gICAgICBsZXQgc3RhcnQgPSB0aGlzLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgbGV0IGVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kO1xuICAgICAgLy8uIHNlbmQgZGVsZXRlIGV2ZW50XG4gICAgICBpZiAoc3RhcnQgIT0gZW5kKSB7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uUmFuZ2UoZW5kLCBlbmQpXG4gICAgICAgIHNlbGYuc2VuZENoYW5nZURhdGEodGhpcywgXCJcIiwgc3RhcnQsIGVuZCwgZmFsc2UpO1xuICAgICAgfVxuICAgICAgaWYoc3RhcnQ9PWVuZCl7XG4gICAgICAgIC8vIHRvIGNhbGN1bGF0ZSBDdXJzb3JzIGluIGNvbGxhYm9yYXRpb24gXG4gICAgICAgIC8vIGN1cnNvcnMucmVjYWxjdWxhdGVfbG9jYWxfY3Vyc29ycyh0aGlzLGNvbnRlbnRfdGV4dC5sZW5ndGgpXG4gICAgICB9XG4gICAgICAvLy4gaW5zZXJ0IGV2ZW50XG4gICAgICBzZWxmLnNlbmRDaGFuZ2VEYXRhKHRoaXMsIGNvbnRlbnRfdGV4dCwgc3RhcnQsIHN0YXJ0LCBmYWxzZSk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgfSlcbiAgICBcbiAgICBpbnB1dF9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NvY3JlYXRlLWNyZHQtdXBkYXRlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHZhciBpbmZvID0gZXZlbnQuZGV0YWlsO1xuICAgICAgaW5wdXRfZWxlbWVudC5jcnVkU2V0dGVkID0gdHJ1ZTtcbiAgICAgIFxuICAgICAgdmFyIHBvcyA9IDA7XG4gICAgICB2YXIgZmxhZyA9IHRydWU7XG5cbiAgICAgIGluZm8uZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgaWYgKGl0ZW0ucmV0YWluKSB7XG4gICAgICAgICAgZmxhZyA9IHRydWU7XG4gICAgICAgICAgcG9zID0gaXRlbS5yZXRhaW47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChpdGVtLmluc2VydCB8fCBpdGVtLmRlbGV0ZSkge1xuICAgICAgICAgIGlmIChmbGFnID09IGZhbHNlKSBwb3MgPSAwO1xuICAgICAgICAgIGZsYWcgPSBmYWxzZTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoaXRlbS5pbnNlcnQpIHtcbiAgICAgICAgICAgIC8vLiBpbnNlcnQgcHJvY2Vzc1xuICAgICAgICAgICAgc2VsZi51cGRhdGVDaGFuZ2VEYXRhKHRoaXMsIGl0ZW0uaW5zZXJ0LCBwb3MsIHBvcylcbiAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uZGVsZXRlKSB7XG4gICAgICAgICAgICAvLy4gZGVsZXRlIHByb2Nlc3NcbiAgICAgICAgICAgIHNlbGYudXBkYXRlQ2hhbmdlRGF0YSh0aGlzLCBcIlwiLCBwb3MsIHBvcyArIGl0ZW0uZGVsZXRlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfSxcblxuICBzZXRTZWxlY3Rpb25JbmZvOmZ1bmN0aW9uKGUsIGlzU2VsZWN0LCBzdGFydCwgZW5kKSB7XG4gICAgZS5zZXRBdHRyaWJ1dGUoXCJpc19zZWxlY3RlZFwiLCBpc1NlbGVjdCk7XG4gICAgZS5zZXRBdHRyaWJ1dGUoXCJzZWxlY3Rpb25fc3RhcnRcIiwgc3RhcnQpO1xuICAgIGUuc2V0QXR0cmlidXRlKFwic2VsZWN0aW9uX2VuZFwiLCBlbmQpO1xuICAgIC8vY29uc29sZS5sb2coXCJzd2VsZWN0XCIsZSlcbiAgICB0aGlzLnNlbmRQb3NpdGlvbihlKTtcbiAgfSxcbiAgXG4gIGdldFNlbGVjdGlvbkluZm86IGZ1bmN0aW9uKGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNfc2VsZWN0ZWQ6IChlLmdldEF0dHJpYnV0ZShcImlzX3NlbGVjdGVkXCIpID09PSAndHJ1ZScpID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgc3RhcnQ6IHBhcnNlSW50KGUuZ2V0QXR0cmlidXRlKFwic2VsZWN0aW9uX3N0YXJ0XCIpKSxcbiAgICAgIGVuZDpwYXJzZUludChlLmdldEF0dHJpYnV0ZShcInNlbGVjdGlvbl9lbmRcIikpXG4gICAgfVxuICB9LFxuXG4gIHNlbmRDaGFuZ2VEYXRhOiBmdW5jdGlvbihlbGVtZW50LCBjb250ZW50LCBzdGFydCwgZW5kLCBpc1JlbW92ZSA9IHRydWUpIHtcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lIH0gPSBjcnVkLmdldEF0dHIoZWxlbWVudClcbiAgICBpZiAoIWRvY3VtZW50X2lkIHx8IGRvY3VtZW50X2lkID09PSBcIlwiKSB7XG4gICAgICBmb3JtLnJlcXVlc3Qoe2VsZW1lbnQ6IGVsZW1lbnQsIG5hbWVBdHRyOiBcIm5hbWVcIn0pXG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1kb2N1bWVudF9pZCcsICdwZW5kaW5nJyk7XG4gICAgICByZXR1cm4gO1xuICAgIH1cbiAgICBcbiAgICBpZiAoZG9jdW1lbnRfaWQgPT0gJ3BlbmRpbmcnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFjcnVkLmlzU2F2ZUF0dHIoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy9jb25zb2xlLmxvZyhcIlNlbmRDaGFuZ2VEYXRhRnJvbSBDb2NyZWF0ZS1UZXh0XCIpXG4gICAgbGV0IGNoYXJhY3Rlcl9jb3VudCA9IGNvbnRlbnQubGVuZ3RoID4gMCA/IGNvbnRlbnQubGVuZ3RoIDogLTE7XG4gICAgY3Vyc29ycy5yZWNhbGN1bGF0ZV9sb2NhbF9jdXJzb3JzKGVsZW1lbnQsY2hhcmFjdGVyX2NvdW50KTtcbiAgICBcbiAgICAgIC8vc2VuZCBwb3NpdGlvbiB3aGVuIGtleVVwIFxuICAgIHRoaXMuc2VuZFBvc2l0aW9uKGVsZW1lbnQpXG4gICAgaWYgKGNvbnRlbnQubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGlzUmVtb3ZlKSAge1xuICAgICAgICBlbGVtZW50LnNldFJhbmdlVGV4dChcIlwiLCBzdGFydCwgc3RhcnQgKyBjb250ZW50Lmxlbmd0aCwgXCJzdGFydFwiKVxuICAgICAgfVxuICAgICAgY3JkdC5pbnNlcnRUZXh0KHtcbiAgICAgICAgY29sbGVjdGlvbiwgZG9jdW1lbnRfaWQsIG5hbWUsXG4gICAgICAgIHZhbHVlOiBjb250ZW50LFxuICAgICAgICBwb3NpdGlvbjogc3RhcnRcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpc1JlbW92ZSkgZWxlbWVudC5zZXRSYW5nZVRleHQoXCIgXCIucmVwZWF0KGVuZCAtIHN0YXJ0KSwgc3RhcnQsIHN0YXJ0LCBcImVuZFwiKVxuICAgICAgY3JkdC5kZWxldGVUZXh0KHtcbiAgICAgICAgY29sbGVjdGlvbiwgZG9jdW1lbnRfaWQsIG5hbWUsXG4gICAgICAgIHBvc2l0aW9uOiBzdGFydCxcbiAgICAgICAgbGVuZ3RoOiBlbmQgLSBzdGFydCxcbiAgICAgIH0pXG4gICAgfVxuICAgIGlmKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGVsZW1lbnQpe1xuICAgICAgdGhpcy5zZXRTZWxlY3Rpb25JbmZvKGVsZW1lbnQsIGZhbHNlLCBlbGVtZW50LnNlbGVjdGlvblN0YXJ0LCBlbGVtZW50LnNlbGVjdGlvblN0YXJ0KTtcbiAgICAgIHRoaXMuc2VuZFBvc2l0aW9uKGVsZW1lbnQpO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGVDaGFuZ2VEYXRhOiBmdW5jdGlvbihlbGVtZW50LCBjb250ZW50LCBzdGFydCwgZW5kKSB7XG5cbiAgICBsZXQgcHJldl9zdGFydCA9IGVsZW1lbnQuc2VsZWN0aW9uU3RhcnQ7XG4gICAgbGV0IHByZXZfZW5kID0gZWxlbWVudC5zZWxlY3Rpb25FbmQ7XG4gICAgZWxlbWVudC5zZXRSYW5nZVRleHQoY29udGVudCwgc3RhcnQsIGVuZCwgXCJlbmRcIik7XG5cbiAgICBpZiAocHJldl9zdGFydCA+PSBzdGFydCkge1xuICAgICAgaWYgKGNvbnRlbnQgPT0gXCJcIikge1xuICAgICAgICBwcmV2X3N0YXJ0IC09IGVuZCAtIHN0YXJ0O1xuICAgICAgICBwcmV2X2VuZCAtPSBlbmQgLSBzdGFydDtcbiAgICAgICAgcHJldl9zdGFydCA9IHByZXZfc3RhcnQgPCBzdGFydCA/IHN0YXJ0IDogcHJldl9zdGFydDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZXZfc3RhcnQgKz0gY29udGVudC5sZW5ndGg7XG4gICAgICAgIHByZXZfZW5kICs9IGNvbnRlbnQubGVuZ3RoO1xuICAgICAgfVxuICAgIH0ge1xuICAgICAgaWYgKGNvbnRlbnQgPT0gXCJcIiAmJiBwcmV2X2VuZCA+PSBzdGFydCkge1xuICAgICAgICBwcmV2X2VuZCA9IChwcmV2X2VuZCA+PSBlbmQpID8gcHJldl9lbmQgLSAoZW5kIC0gc3RhcnQpIDogc3RhcnRcbiAgICAgIH0gXG4gICAgfVxuICAgIFxuICAgIGVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgPSBwcmV2X3N0YXJ0O1xuICAgIGVsZW1lbnQuc2VsZWN0aW9uRW5kID0gcHJldl9lbmQ7XG5cbiAgICB2YXIgaXNGb2N1c2VkID0gKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGVsZW1lbnQpO1xuICAgIGN1cnNvcnMucmVmcmVzaF9taXJyb3IoZWxlbWVudCk7XG4gICAgXG4gICAgaWYgKGZsb2F0aW5nTGFiZWwpICAge1xuICAgICAgZmxvYXRpbmdMYWJlbC51cGRhdGUoZWxlbWVudCwgZWxlbWVudC52YWx1ZSlcbiAgICB9XG5cbiAgfSxcbiAgXG4gIGdlbmVyYXRlVHlwZU5hbWU6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGNvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lIH0gPSBjcnVkLmdldEF0dHIoZWxlbWVudClcbiAgICBcbiAgICByZXR1cm4gY3JkdC5nZW5lcmF0ZUlEKGNvbmZpZy5vcmdhbml6YXRpb25fSWQsIGNvbGxlY3Rpb24sIGRvY3VtZW50X2lkLCBuYW1lKTtcbiAgfSxcbiAgXG4gIHNldFRleHQ6IGZ1bmN0aW9uKGVsZW1lbnRfaWQsIGluZm8pIHtcbiAgICB2YXIgcG9zID0gMDtcbiAgICB2YXIgZmxhZyA9IHRydWU7XG4gICAgXG4gICAgaW5mby5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaWYgKGl0ZW0ucmV0YWluKSB7XG4gICAgICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICBwb3MgPSBpdGVtLnJldGFpbjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGl0ZW0uaW5zZXJ0IHx8IGl0ZW0uZGVsZXRlKSB7XG4gICAgICAgIGlmIChmbGFnID09IGZhbHNlKSBwb3MgPSAwO1xuICAgICAgICBmbGFnID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXRlbS5pbnNlcnQpIHtcbiAgICAgICAgICAvLy4gaW5zZXJ0IHByb2Nlc3NcbiAgICAgICAgICB0aGlzLnJlY2VpdmVDaGFuZ2VEYXRhKGVsZW1lbnRfaWQsIGl0ZW0uaW5zZXJ0LCBwb3MsIHBvcylcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLmRlbGV0ZSkge1xuICAgICAgICAgIC8vLiBkZWxldGUgcHJvY2Vzc1xuICAgICAgICAgIHRoaXMucmVjZWl2ZUNoYW5nZURhdGEoZWxlbWVudF9pZCwgXCJcIiwgcG9zLCBwb3MgKyBpdGVtLmRlbGV0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgXG4gIGlzQXZhaWFibGVFbDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIC8vY29uc29sZS5sb2codGhpcy5lbGVtZW50cylcbiAgICBcbiAgICBmb3IgKHZhciAgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVsZW1lbnRzW2ldLmlzRXF1YWxOb2RlKGVsZW1lbnQpLGVsZW1lbnQpXG4gICAgICBpZiAodGhpcy5lbGVtZW50c1tpXS5pc0VxdWFsTm9kZShlbGVtZW50KT09PXRydWUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgXG4gIHNlbmRQb3NpdGlvbjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIC8vY29uc29sZS5sb2coXCJTZSBlbnZpbyBcIilcbiAgICAvKmlmICghdGhpcy5pc0F2YWlhYmxlRWwoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9Ki9cbiAgICBcbiAgICBjb25zdCBpZCA9IHRoaXMuZ2VuZXJhdGVUeXBlTmFtZShlbGVtZW50KTtcbiAgICAvL2NvbnNvbGUubG9nKFwiIFNFbmQgUG9zaXRpb24gU2VsZWN0b3IgSUQgXCIsaWQpXG4gICAgLy9jb25zb2xlLmxvZyhlbGVtZW50LnNlbGVjdGlvblN0YXJ0LCBlbGVtZW50LnNlbGVjdGlvbkVuZCk7XG4gICAgbGV0IGZyb20gPSBlbGVtZW50LnNlbGVjdGlvblN0YXJ0O1xuICAgIGxldCB0byA9IGVsZW1lbnQuc2VsZWN0aW9uRW5kO1xuICAgIC8vY29uc29sZS5sb2coXCJTZSBlbnZpbyBsYSBwb3NpdGlvbiBcIixpZCxmcm9tLCB0bylcbiAgICBjcmR0LnNldFBvc2l0aW9uWUpTKGlkLCBmcm9tLCB0byk7XG4gICAgXG4gIH1cbn1cblxuXG5Db0NyZWF0ZVRleHQuaW5pdCgpO1xuLy8gQ29DcmVhdGVJbml0LnJlZ2lzdGVyKCdDb0NyZWF0ZVRleHQnLCBDb0NyZWF0ZVRleHQsIENvQ3JlYXRlVGV4dC5pbml0RWxlbWVudCk7XG5cbm9ic2VydmVyLmluaXQoeyBcblx0bmFtZTogJ0NvQ3JlYXRlVGV4dENyZWF0ZScsIFxuXHRvYnNlcnZlOiBbJ3N1YnRyZWUnLCAnY2hpbGRMaXN0J10sXG5cdGluY2x1ZGU6ICdbZGF0YS1jb2xsZWN0aW9uXVtkYXRhLWRvY3VtZW50X2lkXVtuYW1lXScsIFxuXHRjYWxsYmFjazogZnVuY3Rpb24obXV0YXRpb24pIHtcblx0ICBjb25zb2xlLmxvZygnY29jcmVhdGUtdGV4dCBpbml0Jylcblx0XHRDb0NyZWF0ZVRleHQuaW5pdEVsZW1lbnQobXV0YXRpb24udGFyZ2V0KVxuXHR9XG59KTtcblxub2JzZXJ2ZXIuaW5pdCh7IFxuXHRuYW1lOiAnQ29DcmVhdGVUZXh0TmFtZU9ic2VydmVyJywgXG5cdG9ic2VydmU6IFsnYXR0cmlidXRlcyddLFxuXHRhdHRyaWJ1dGVzOiBbJ25hbWUnXSxcblx0Y2FsbGJhY2s6IGZ1bmN0aW9uKG11dGF0aW9uKSB7XG5cdFx0Y29uc29sZS5sb2coJ2NoYW5nZSBjb2NyZWF0ZS10ZXh0IG5hbWUnKVxuXHRcdENvQ3JlYXRlVGV4dC5yZWZyZXNoRWxlbWVudChtdXRhdGlvbilcblx0fVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IENvQ3JlYXRlVGV4dDsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../CoCreate-text/src/index.js\n")}}]);